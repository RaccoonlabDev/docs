(window.webpackJsonp=window.webpackJsonp||[]).push([[93],{273:function(e,t,n){e.exports=n.p+"assets/img/ice.fef528c6.png"},777:function(e,t,n){"use strict";n.r(t);var a=n(14),i=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"_1-dronecan-internal-combustion-engine-node"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-dronecan-internal-combustion-engine-node"}},[e._v("#")]),e._v(" 1. DroneCAN Internal Combustion Engine node")]),e._v(" "),t("p",[e._v("The ICE node is designed to control an internal combustion engine such as the "),t("a",{attrs:{href:"http://rcstv.ru/static/fileunit/107b61373aea5dbedd58c2029d3c781fe909c3d9/DLE%2020%20Hobbico%20Manual%20Best.pdf",target:"_blank",rel:"noopener noreferrer"}},[e._v("DLE-20"),t("OutboundLink")],1),e._v(" or "),t("a",{attrs:{href:"http://manuals.hobbico.com/dle/dleg0435-manual.pdf",target:"_blank",rel:"noopener noreferrer"}},[e._v("DLE-35"),t("OutboundLink")],1),e._v(" using Electronic Ignition Module.")]),e._v(" "),t("img",{attrs:{src:n(273),alt:"drawing",width:"400"}}),e._v(" "),t("p",[e._v("The node has 2 input sources - commands from an autopilot. It subscribes to:")]),e._v(" "),t("ul",[t("li",[e._v("a specific channel of "),t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#rawcommand",target:"_blank",rel:"noopener noreferrer"}},[e._v("esc.RawCommand"),t("OutboundLink")],1),e._v(". This is the main and mandatory command and it controls the gas and air throttles, spark ignition and starter motor.")]),e._v(" "),t("li",[e._v("a specific channel of "),t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#arraycommand",target:"_blank",rel:"noopener noreferrer"}},[e._v("actuator.ArrayCommand"),t("OutboundLink")],1),e._v(". This command is optional and it allows tuning the open position of the air throttle in real time (not supported in the main branch of the PX4 autopilot).")])]),e._v(" "),t("h2",{attrs:{id:"_1-1-starter-motor"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-starter-motor"}},[e._v("#")]),e._v(" 1.1. Starter motor")]),e._v(" "),t("p",[e._v("The primary function of the starter motor is to rotate the engine's crankshaft at a speed sufficient to initiate the combustion process. The ICE node has 3 states:")]),e._v(" "),t("ol",[t("li",[e._v("By default, it has "),t("code",[e._v("STATE_STOPPED")]),e._v(", that simply means that the engine is not running. A node will imidiatelly go to this state from any other states if it receives a negatie setpoint (< 0).")]),e._v(" "),t("li",[e._v("If the node receives a setpoint to start (> 0) and the engine is not rotating yet, the node goes to a "),t("code",[e._v("STATE_STARTING")]),e._v(" state. This is a transient state. The duration is configured with a parameter (1500 ms by default). In this state teh starter motor is enabled.")]),e._v(" "),t("li",[e._v("After that the node goes into "),t("code",[e._v("STATE_RUNNING")]),e._v(" state. During this state the starter is disabled. After some period of time configured with another parameter (500 ms by default), the node consistently performs the following check: if the engine is not rotation, then go back to the "),t("code",[e._v("STATE_STARTING")]),e._v(".")])]),e._v(" "),t("blockquote",[t("p",[e._v("It is extected to use "),t("code",[e._v("EME35")]),e._v(" starter motor.")])]),e._v(" "),t("h2",{attrs:{id:"_1-2-spark-ignition"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-spark-ignition"}},[e._v("#")]),e._v(" 1.2. Spark Ignition")]),e._v(" "),t("p",[e._v("Spark Ignition control is automatically done by ECU. A node can only forcly turn off the spark engine.")]),e._v(" "),t("p",[e._v("If setpoint >= 0, then the spark engine is enabled, the the ECU can control it. If the setpoint is negative, then the spark ignition is disabled.")]),e._v(" "),t("h2",{attrs:{id:"_1-3-gas-throttle"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-gas-throttle"}},[e._v("#")]),e._v(" 1.3. Gas throttle")]),e._v(" "),t("p",[e._v("Gas throttle is linearly controller by the RawCommand.")]),e._v(" "),t("p",[e._v("A user during the node configuration should specify "),t("code",[e._v("throttle.gas.min_def")]),e._v(" and "),t("code",[e._v("throttle.gas.max")]),e._v(" values of PWM related to closed and open state of the gas throttle.")]),e._v(" "),t("p",[e._v("If a configured channel in RawCommand is less or equal than 0, the gas throttle will be closed and the engine turn off. If a setpoint is 8191, the gas throttle will be fully opened and the engine have the maximum thrust.")]),e._v(" "),t("p",[e._v("If there is no setpoint for 500 ms, for the safety reasons the gas throttle will be closed.")]),e._v(" "),t("h2",{attrs:{id:"_1-4-air-throttle"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-air-throttle"}},[e._v("#")]),e._v(" 1.4. Air throttle")]),e._v(" "),t("p",[e._v("When starting an internal combustion engine, the control of the air servo is crucial for achieving an optimal air-fuel mixture for ignition.")]),e._v(" "),t("p",[e._v("The node automatically controls the air servo based on a setpoint (esc.RawCommand) and an engine state estimation.")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Default Position (Engine is disabled)")]),e._v(" "),t("p",[e._v("When engine is disabled, the air throttle position remains open. If PX4 supports, a user can ajust the open position in real time with ArrayCommand. Typically, it can be done with a remote controller.")])]),e._v(" "),t("li",[t("p",[e._v("Cranking Phase")]),e._v(" "),t("p",[e._v("During cranking (when the starter motor is turning the engine), the air throttle rapidly goes to the closed position and then slowly opens to a user specified position withing a configred in the parameters time interval.")]),e._v(" "),t("p",[e._v("For most engines, especially in cold start conditions, the throttle (and thus the air servo) should be in a nearly closed position to ensure a rich air-fuel mixture. A richer mixture (more fuel relative to air) is easier to ignite, which is crucial for starting the engine.")])]),e._v(" "),t("li",[t("p",[e._v("Post-Start (Engine Fires Up)")]),e._v(" "),t("p",[e._v("Once the engine fires and begins to run, the throttle goes to a open position (configured in the parameters and optionally tuned in real time by a user) to stabilize the engine's idle speed.")])])]),e._v(" "),t("p",[e._v("Throttle Closed (or Nearly Closed): For most engines, especially in cold start conditions, the throttle (and thus the air servo) should be in a nearly closed position to ensure a rich air-fuel mixture. A richer mixture (more fuel relative to air) is easier to ignite, which is crucial for starting the engine.")]),e._v(" "),t("p",[e._v("When the started is enabled, the air throttle rapidly goes to the closed state, so we have less air, more fuel and the engine starts easier.")]),e._v(" "),t("p",[e._v("Within a given time interval, the air servo will move to the open position. If supported by PX4, the open position can be configured by a user in real time using ArrayCommand.")]),e._v(" "),t("p",[e._v("If engine starts sucessfully, the air servo remains open.")]),e._v(" "),t("h2",{attrs:{id:"_1-5-feedback"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-feedback"}},[e._v("#")]),e._v(" 1.5. Feedback")]),e._v(" "),t("p",[e._v("The node sends 2 messages back to the the autopilot with various of data including:")]),e._v(" "),t("ul",[t("li",[e._v("engine state (stopped, starting or running)")]),e._v(" "),t("li",[e._v("spark engine state (either enabled or disabled)")]),e._v(" "),t("li",[e._v("engine speed RPM")]),e._v(" "),t("li",[e._v("gas throttle load percent")]),e._v(" "),t("li",[e._v("air throttle load percent")]),e._v(" "),t("li",[e._v("starter current and voltage")]),e._v(" "),t("li",[e._v("voltage: 5v and vin")]),e._v(" "),t("li",[e._v("stm32 temperature")]),e._v(" "),t("li",[e._v("(if supported) external temperature")])]),e._v(" "),t("h2",{attrs:{id:"_1-6-firmware"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-firmware"}},[e._v("#")]),e._v(" 1.6. Firmware")]),e._v(" "),t("p",[e._v("DroneCAN firmware")]),e._v(" "),t("blockquote",[t("p",[e._v("in process")])])])}),[],!1,null,null,null);t.default=i.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{279:function(t,e,s){t.exports=s.p+"assets/img/connection-prog.1955457f.png"},700:function(t,e,s){t.exports=s.p+"assets/img/linux-stlink-success.6ff92777.png"},701:function(t,e,s){t.exports=s.p+"assets/img/issue_unknown_chipid.c53b5097.png"},811:function(t,e,s){"use strict";s.r(e);var a=s(14),r=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"update-the-firmware-with-rl-programmer-on-linux-with-stlink"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#update-the-firmware-with-rl-programmer-on-linux-with-stlink"}},[t._v("#")]),t._v(" Update the firmware with RL-programmer on Linux with stlink")]),t._v(" "),e("h3",{attrs:{id:"step-1-download-firmware"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-1-download-firmware"}},[t._v("#")]),t._v(" Step 1. Download firmware")]),t._v(" "),e("p",[t._v("Download the latest firmware from "),e("RouterLink",{attrs:{to:"/guide/intro/firmware_upload.html"}},[t._v("Update the firmware")]),t._v(" page.")],1),t._v(" "),e("h3",{attrs:{id:"step-2-1-install-software"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-2-1-install-software"}},[t._v("#")]),t._v(" Step 2.1. Install software")]),t._v(" "),e("p",[t._v("At the moment of writing, the latest stable version of ST-link software from APT is v1.7.0 on Apr 25, 2021 and it "),e("a",{attrs:{href:"https://github.com/stlink-org/stlink/blob/v1.7.0/doc/devices_boards.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("doesn't support STM32G0B (Chip-ID 0x467)"),e("OutboundLink")],1),t._v(". Instead of using binary releases, follow the instructions from the official st-link manual on "),e("a",{attrs:{href:"https://github.com/stlink-org/stlink/blob/develop/doc/compiling.md#linux",target:"_blank",rel:"noopener noreferrer"}},[t._v("Compiling from sources"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("Here's a summarized version for a quick setup:")]),t._v(" "),e("ol",[e("li",[e("p",[e("strong",[t._v("Remove Older Versions")]),t._v(":\nMake sure you uninstall any older versions of st-link on your system.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" remove "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--purge")]),t._v(" libstlink1 stlink\n")])])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Clone the Latest st-link Repository")]),t._v(":\nClone the official st-link repository from GitHub.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/stlink-org/stlink.git\n")])])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Install libusb")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("sudo apt-get install git make cmake libusb-1.0-0-dev\n")])])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Build and Install")]),t._v(":\nNavigate into the cloned directory and install the software.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" stlink/\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" release\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ldconfig\n")])])])])]),t._v(" "),e("h3",{attrs:{id:"step-2-2-connect-the-programmer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-2-2-connect-the-programmer"}},[t._v("#")]),t._v(" Step 2.2. Connect the programmer")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("Be sure that your SWD pins on the node and the needle sides are connected correctly (3.3 to 3.3, GND to GND).")])]),t._v(" "),e("p",[t._v("Prerequisites are: "),e("RouterLink",{attrs:{to:"/guide/programmer_sniffer/"}},[t._v("RL Programmer-Sniffer")]),t._v(", "),e("a",{attrs:{href:"https://github.com/RaccoonLabHardware/SWD-NEEDLE",target:"_blank",rel:"noopener noreferrer"}},[t._v("SWD-NEEDLE"),e("OutboundLink")],1),t._v(" and JST-GH 4 cable. An example of a connection is shown below.")],1),t._v(" "),e("p",[e("img",{attrs:{src:s(279),alt:"connection-prog.png",title:"connection-prog.png"}})]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("SWD and CAN sockets look similar and they use the same 4-pin cable. SWD has 3.3V, but CAN has 5V. Don't mix them up.")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("On the RL programmer "),e("code",[t._v("VUSB")]),t._v(" led should be orange, "),e("code",[t._v("3.3")]),t._v(" led should be red, "),e("code",[t._v("ST-link")]),t._v(" led should be blue, and "),e("code",[t._v("blink")]),t._v(" led should blink with yellow. If they are not, probably you are making something wrong. It also may indicate that the board works incorrectly.")])]),t._v(" "),e("h3",{attrs:{id:"step-2-3-upload-the-firmware"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-2-3-upload-the-firmware"}},[t._v("#")]),t._v(" Step 2.3. Upload the firmware")]),t._v(" "),e("p",[t._v("It is expected to use the latest version of st-link installed from sources:")]),t._v(" "),e("ol",[e("li",[e("p",[e("strong",[t._v("Program the Firmware")]),t._v(":")]),t._v(" "),e("p",[t._v("To program the boards with stm32f103 (they all have version v2), you should explicitly specify the flash size (128 KBytes):")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("st-flash "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--flash")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("0x00020000 "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--reset")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),t._v(" desired_bin_file.bin 0x8000000\n")])])]),e("p",[t._v("For boards with stm32g0 (they all have version v3), you should type:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("st-flash "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--reset")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),t._v(" desired_bin_file.bin 0x8000000\n")])])]),e("p",[t._v("Make sure to replace "),e("code",[t._v("desired_bin_file.bin")]),t._v(" with the path to your actual firmware file.")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Verification")]),t._v(":")]),t._v(" "),e("p",[t._v("After the process completes, ensure that the firmware has been successfully uploaded (check stlink messages). Confirm that the device operates correctly.")]),t._v(" "),e("img",{attrs:{src:s(700),alt:"drawing",width:"512"}})]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Issues")]),t._v(":")]),t._v(" "),e("p",[t._v("I have "),e("code",[t._v("unknown chip ID!")]),t._v(" error.")]),t._v(" "),e("img",{attrs:{src:s(701),alt:"drawing",width:"512"}}),t._v(" "),e("p",[t._v("Please, install the latest version of st-link.")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);
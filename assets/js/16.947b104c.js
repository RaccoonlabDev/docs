(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{276:function(e,t,o){e.exports=o.p+"assets/img/circuit_status.c0b6d699.png"},300:function(e,t,o){e.exports=o.p+"assets/img/bench_test_standby.e8b9d676.gif"},301:function(e,t,o){e.exports=o.p+"assets/img/bench_test_mini_v2.2ad536c6.png"},304:function(e,t,o){e.exports=o.p+"assets/img/app_setup.d8b50db6.png"},305:function(e,t,o){e.exports=o.p+"assets/img/device_temperature.34fabd3d.png"},425:function(e,t,o){e.exports=o.p+"assets/img/log_messages.a7bc519a.png"},426:function(e,t,o){e.exports=o.p+"assets/img/mini_v2_with_esc_flame.0ffb552f.png"},427:function(e,t,o){e.exports=o.p+"assets/img/mini_v2_with_esc_thunder.6f76cb65.png"},428:function(e,t,o){e.exports=o.p+"assets/img/mini_v2_with_esc_alpha.b69e9f05.png"},429:function(e,t,o){e.exports=o.p+"assets/img/gui_tool.059b4b8a.png"},430:function(e,t,o){e.exports=o.p+"assets/img/actuator_panel.86ec92a5.gif"},431:function(e,t,o){e.exports=o.p+"assets/img/servo_control.7fbb7f0f.gif"},736:function(e,t,o){"use strict";o.r(t);var a=o(14),r=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"_6-dronecan-pwm-node"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-dronecan-pwm-node"}},[e._v("#")]),e._v(" 6. DroneCAN PWM node")]),e._v(" "),t("p",[e._v("This page is about DroneCAN software related details such as interface, supported features, parameters, configuration and usage example and versions history. For general information please refer "),t("RouterLink",{attrs:{to:"/guide/can_pwm/"}},[e._v("1. General")]),e._v(", for hardware related details including connection example scheme please refer "),t("RouterLink",{attrs:{to:"/guide/can_pwm/can_pwm_micro.html"}},[e._v("2. uNode")]),e._v(" or "),t("RouterLink",{attrs:{to:"/guide/can_pwm/can_pwm_mini_v2.html"}},[e._v("4. Mini v2 node")]),e._v(".")],1),e._v(" "),t("p",[e._v("This section is related to the latest released version of the software.")]),e._v(" "),t("h2",{attrs:{id:"_6-1-dronecan-interface"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-dronecan-interface"}},[e._v("#")]),e._v(" 6.1. DroneCAN interface")]),e._v(" "),t("p",[e._v("This node interacts with the following messages:")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("№")]),e._v(" "),t("th",[e._v("type")]),e._v(" "),t("th",[e._v("message")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("1")]),e._v(" "),t("td",[e._v("subscriber")]),e._v(" "),t("td",[t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#rawcommand",target:"_blank",rel:"noopener noreferrer"}},[e._v("uavcan.equipment.esc.RawCommand"),t("OutboundLink")],1)])]),e._v(" "),t("tr",[t("td",[e._v("2")]),e._v(" "),t("td",[e._v("subscriber")]),e._v(" "),t("td",[t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#arraycommand",target:"_blank",rel:"noopener noreferrer"}},[e._v("uavcan.equipment.actuator.ArrayCommand"),t("OutboundLink")],1)])]),e._v(" "),t("tr",[t("td",[e._v("3")]),e._v(" "),t("td",[e._v("publisher")]),e._v(" "),t("td",[t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#status-2",target:"_blank",rel:"noopener noreferrer"}},[e._v("uavcan.equipment.esc.Status"),t("OutboundLink")],1)])]),e._v(" "),t("tr",[t("td",[e._v("4")]),e._v(" "),t("td",[e._v("publisher")]),e._v(" "),t("td",[t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#circuitstatus",target:"_blank",rel:"noopener noreferrer"}},[e._v("uavcan.equipment.power.CircuitStatus"),t("OutboundLink")],1)])]),e._v(" "),t("tr",[t("td",[e._v("5")]),e._v(" "),t("td",[e._v("publisher")]),e._v(" "),t("td",[t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#logmessage",target:"_blank",rel:"noopener noreferrer"}},[e._v("uavcan.protocol.debug.LogMessage"),t("OutboundLink")],1)])]),e._v(" "),t("tr",[t("td",[e._v("6")]),e._v(" "),t("td",[e._v("publisher")]),e._v(" "),t("td",[t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#temperature",target:"_blank",rel:"noopener noreferrer"}},[e._v("uavcan.equipment.device.Temperature"),t("OutboundLink")],1)])])])]),e._v(" "),t("p",[e._v("Besides required and highly recommended functions such as "),t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#nodestatus",target:"_blank",rel:"noopener noreferrer"}},[e._v("NodeStatus"),t("OutboundLink")],1),e._v(" and "),t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#getnodeinfo",target:"_blank",rel:"noopener noreferrer"}},[e._v("GetNodeInfo"),t("OutboundLink")],1),e._v(" this node also supports the following application-level functions:")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("№")]),e._v(" "),t("th",[e._v("type")]),e._v(" "),t("th",[e._v("message")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("1")]),e._v(" "),t("td",[e._v("RPC-service")]),e._v(" "),t("td",[t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#uavcanprotocolparam",target:"_blank",rel:"noopener noreferrer"}},[e._v("uavcan.protocol.param"),t("OutboundLink")],1)])]),e._v(" "),t("tr",[t("td",[e._v("2")]),e._v(" "),t("td",[e._v("RPC-service")]),e._v(" "),t("td",[t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#restartnode",target:"_blank",rel:"noopener noreferrer"}},[e._v("uavcan.protocol.RestartNode"),t("OutboundLink")],1)])]),e._v(" "),t("tr",[t("td",[e._v("3")]),e._v(" "),t("td",[e._v("RPC-service")]),e._v(" "),t("td",[t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#gettransportstats",target:"_blank",rel:"noopener noreferrer"}},[e._v("uavcan.protocol.GetTransportStats"),t("OutboundLink")],1)])])])]),e._v(" "),t("p",[t("strong",[e._v("1. Circuit status")])]),e._v(" "),t("p",[e._v("PWM-node as well as any other our nodes measures and sends "),t("code",[e._v("5V")]),e._v(" and "),t("code",[e._v("Vin")]),e._v(" voltages as 2 "),t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#circuitstatus",target:"_blank",rel:"noopener noreferrer"}},[e._v("uavcan.equipment.power.CircuitStatus"),t("OutboundLink")],1),e._v(" messages")]),e._v(" "),t("p",[e._v("The first message has "),t("code",[e._v("circuit_id=NODE_ID*10 + 0")]),e._v(" and following 3 significant fields:")]),e._v(" "),t("ol",[t("li",[e._v("voltage - is the 5V voltage")]),e._v(" "),t("li",[e._v("current - is the max current for the last 0.5 seconds (supported only by "),t("code",[e._v("5A")]),e._v(" node)")]),e._v(" "),t("li",[e._v("error_flags - might have ERROR_FLAG_OVERVOLTAGE or ERROR_FLAG_UNDERVOLTAGE or non of them")])]),e._v(" "),t("p",[e._v("The second message has "),t("code",[e._v("circuit_id=NODE_ID*10 + 1")]),e._v(" and following 3 significant fields:")]),e._v(" "),t("ol",[t("li",[e._v("voltage - is the Vin voltage")]),e._v(" "),t("li",[e._v("current - is the average current for the last 0.5 seconds (supported only by "),t("code",[e._v("5A")]),e._v(" node)")]),e._v(" "),t("li",[e._v("error_flags - ERROR_FLAG_UNDERVOLTAGE or non of them. There is no ERROR_FLAG_OVERVOLTAGE flag because the expected max Vin voltage is unknown.")])]),e._v(" "),t("p",[t("strong",[e._v("2. Device temperature")])]),e._v(" "),t("p",[e._v("The node measures and sends device temperature as "),t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#temperature",target:"_blank",rel:"noopener noreferrer"}},[e._v("uavcan.equipment.device.Temperature"),t("OutboundLink")],1),e._v(" message.")]),e._v(" "),t("p",[t("strong",[e._v("3 Log messages")])]),e._v(" "),t("p",[e._v("The node may inform you with a text message when something happen. It uses "),t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#logmessage",target:"_blank",rel:"noopener noreferrer"}},[e._v("uavcan.protocol.debug.LogMessage"),t("OutboundLink")],1),e._v(" message.")]),e._v(" "),t("p",[e._v("A visualization of this message in "),t("code",[e._v("gui_tool")]),e._v(" in case of error shown on a picture below.")]),e._v(" "),t("p",[t("img",{attrs:{src:o(425),alt:"log_messages",title:"log_messages"}})]),e._v(" "),t("p",[e._v("This message might be used in PX4 as "),t("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/master/src/drivers/uavcan/logmessage.hpp",target:"_blank",rel:"noopener noreferrer"}},[e._v("logmessage"),t("OutboundLink")],1),e._v(" feature.")]),e._v(" "),t("p",[t("strong",[e._v("4 Esc Status")])]),e._v(" "),t("p",[e._v("If you use "),t("a",{attrs:{href:"https://store.tmotor.com/category.php?id=20",target:"_blank",rel:"noopener noreferrer"}},[e._v("Tmotor ESC Flame 80 A"),t("OutboundLink")],1),e._v(" it might be possible to get feedback from it via UART port. On the image below you can see an example of connection scheme. Here "),t("code",[e._v("pwm.4_ch")]),e._v(" is configured on a particular channel and "),t("code",[e._v("pwm.fb_2_type = 1")]),e._v(" (esc flame mode).")]),e._v(" "),t("p",[t("img",{attrs:{src:o(426),alt:"mini_v2_with_esc_flame",title:"mini_v2_with_esc_flame"}})]),e._v(" "),t("p",[e._v("If you use "),t("a",{attrs:{href:"https://store.tmotor.com/category.php?id=20",target:"_blank",rel:"noopener noreferrer"}},[e._v("Tmotor ESC Thunder 300 A"),t("OutboundLink")],1),e._v(" it might be possible to get feedback from it via UART port. Here the mini node is connected to a single ESC Thunder and configured as RawCommand channel 0. A second ESC Thunder can be connected as well.")]),e._v(" "),t("p",[t("img",{attrs:{src:o(427),alt:"mini_v2_with_esc_thunder",title:"mini_v2_with_esc_thunder"}})]),e._v(" "),t("p",[t("a",{attrs:{href:"https://store.tmotor.com/category-59-b0-ALPHA+Series.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Tmotor ESC Alpha 180 A"),t("OutboundLink")],1),e._v(" is supported as well. On the image below you can see an example of connection scheme. Here "),t("code",[e._v("pwm.1_ch")]),e._v(" is configured on a particular channel and "),t("code",[e._v("pwm.fb_1_type = 3")]),e._v(" (esc alpha mode).")]),e._v(" "),t("p",[t("img",{attrs:{src:o(428),alt:"mini_v2_with_esc_alpha",title:"mini_v2_with_esc_alpha"}})]),e._v(" "),t("p",[e._v("In this case, the PWM node will send "),t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#status-2",target:"_blank",rel:"noopener noreferrer"}},[e._v("uavcan.equipment.esc.Status"),t("OutboundLink")],1),e._v(" for each of up to 2 activated channels.")]),e._v(" "),t("p",[e._v("It will fill the following fields of the message:")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("№")]),e._v(" "),t("th",[e._v("Field name")]),e._v(" "),t("th",[e._v("Description")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("1")]),e._v(" "),t("td",[e._v("error_count")]),e._v(" "),t("td",[e._v("This field is used for debug only. The value is incremented after receiving of each byte. If it doesn't change, typically your UART connection is broken.")])]),e._v(" "),t("tr",[t("td",[e._v("2")]),e._v(" "),t("td",[e._v("voltage")]),e._v(" "),t("td",[e._v("Voltage on the regulator, volt.")])]),e._v(" "),t("tr",[t("td",[e._v("3")]),e._v(" "),t("td",[e._v("current")]),e._v(" "),t("td",[e._v("Current, ampere.")])]),e._v(" "),t("tr",[t("td",[e._v("4")]),e._v(" "),t("td",[e._v("temperature")]),e._v(" "),t("td",[e._v("Temperature, kelvin.")])]),e._v(" "),t("tr",[t("td",[e._v("5")]),e._v(" "),t("td",[e._v("rpm")]),e._v(" "),t("td",[e._v("Rotation per minute.")])]),e._v(" "),t("tr",[t("td",[e._v("4")]),e._v(" "),t("td",[e._v("esc_index")]),e._v(" "),t("td",[e._v("Index of esc. From 0 to 31.")])])])]),e._v(" "),t("p",[e._v("This feature is supported only by "),t("a",{attrs:{href:"can_pwm_mini_v2"}},[e._v("mini v2")]),e._v(" node. "),t("a",{attrs:{href:"can_pwm_micro"}},[e._v("micro")]),e._v(" node doesn't support this feature.")]),e._v(" "),t("blockquote",[t("p",[e._v("Since ESC regulator doesn't now about the number of poles, you typically need to set the correponded value with "),t("code",[e._v("mot_num_poles")]),e._v(" parameter.")])]),e._v(" "),t("h2",{attrs:{id:"_6-2-dronecan-parameters"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-dronecan-parameters"}},[e._v("#")]),e._v(" 6.2. DroneCAN Parameters")]),e._v(" "),t("p",[e._v("Below you can see the table with complete set of the node parameters.")]),e._v(" "),t("p",[e._v("The actual list of parameters on your node depends on the firmware version and hardware type.")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("№")]),e._v(" "),t("th",[e._v("Parameter name")]),e._v(" "),t("th",[e._v("Note")]),e._v(" "),t("th",[e._v("Description")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("0")]),e._v(" "),t("td",[e._v("uavcan.node.id")]),e._v(" "),t("td",[e._v("Reboot required")]),e._v(" "),t("td",[e._v("Node identifier")])]),e._v(" "),t("tr",[t("td",[e._v("1")]),e._v(" "),t("td",[e._v("stats.flight_time_sec")]),e._v(" "),t("td"),e._v(" "),t("td",[e._v("The total flight time in seconds. Appeared since v0.5.2")])]),e._v(" "),t("tr",[t("td",[e._v("2")]),e._v(" "),t("td",[e._v("pwm.cmd_type")]),e._v(" "),t("td",[e._v("Reboot required")]),e._v(" "),t("td",[e._v("0 means RawCommand, 1 means ArrayCommand. Appeared since v0.5.2")])]),e._v(" "),t("tr",[t("td",[e._v("3")]),e._v(" "),t("td",[e._v("pwm.frequency")]),e._v(" "),t("td",[e._v("Reboot required")]),e._v(" "),t("td",[e._v("Pwm frequency from 50 to 400 Hz. Appeared since v0.8.8")])]),e._v(" "),t("tr",[t("td",[e._v("4")]),e._v(" "),t("td",[e._v("pwm.*_ch")]),e._v(" "),t("td"),e._v(" "),t("td",[e._v("Index of setpoint channel. -1 means disabled, -2 means GPIO SET.")])]),e._v(" "),t("tr",[t("td",[e._v("5")]),e._v(" "),t("td",[e._v("pwm.*_min")]),e._v(" "),t("td"),e._v(" "),t("td",[e._v("PWM duration when setpoint is min.")])]),e._v(" "),t("tr",[t("td",[e._v("6")]),e._v(" "),t("td",[e._v("pwm.*_max")]),e._v(" "),t("td"),e._v(" "),t("td",[e._v("PWM duration when setpoint is max.")])]),e._v(" "),t("tr",[t("td",[e._v("7")]),e._v(" "),t("td",[e._v("pwm.*_def")]),e._v(" "),t("td"),e._v(" "),t("td",[e._v("PWM duration when setpoint is negative or there is no setpoint at all.")])]),e._v(" "),t("tr",[t("td",[e._v("8")]),e._v(" "),t("td",[e._v("pwm.mot_num_poles")]),e._v(" "),t("td"),e._v(" "),t("td",[e._v("Motor number of poles. Appeared since v0.9.8")])]),e._v(" "),t("tr",[t("td",[e._v("9")]),e._v(" "),t("td",[e._v("pwm.fb_*_type")]),e._v(" "),t("td"),e._v(" "),t("td",[e._v("ESC feedback type (fb1 ~ pwm3, fb2 ~ pwm4):"),t("br"),e._v("- 0 - disabled (by default),"),t("br"),e._v("- 1 - ESC Flame,"),t("br"),e._v("- 2 - ESC Thunder(since v0.12),"),t("br"),e._v("- 3 - ESC Alpha (since v0.13),"),t("br"),e._v("- 4-9 - reserved,"),t("br"),e._v("- 10+ - forward mode with custom UART baudrate (since v0.12).")])]),e._v(" "),t("tr",[t("td",[e._v("10")]),e._v(" "),t("td",[e._v("enable_5v_check")]),e._v(" "),t("td"),e._v(" "),t("td",[e._v("Set ERROR status if 5V voltage is out of range 4.5 - 5.5 V")])]),e._v(" "),t("tr",[t("td",[e._v("11")]),e._v(" "),t("td",[e._v("enable_vin_check")]),e._v(" "),t("td"),e._v(" "),t("td",[e._v("Set ERROR status if Vin voltage is less than 4.5 V")])]),e._v(" "),t("tr",[t("td",[e._v("12")]),e._v(" "),t("td",[e._v("cmd_ttl_ms")]),e._v(" "),t("td"),e._v(" "),t("td",[t("a",{attrs:{href:"https://en.wikipedia.org/wiki/Time_to_live",target:"_blank",rel:"noopener noreferrer"}},[e._v("Time to live"),t("OutboundLink")],1),e._v(" timeout")])]),e._v(" "),t("tr",[t("td",[e._v("13")]),e._v(" "),t("td",[e._v("system.can_bus_check_level")]),e._v(" "),t("td"),e._v(" "),t("td",[e._v("Every CAN bus error will be treated as a specified level of error. Appeared since v0.9.8")])]),e._v(" "),t("tr",[t("td",[e._v("14")]),e._v(" "),t("td",[e._v("system.log_level")]),e._v(" "),t("td",[e._v("Reboot required")]),e._v(" "),t("td",[e._v("Specify what level of log can be sent. Appeared since v0.5.2")])]),e._v(" "),t("tr",[t("td",[e._v("15")]),e._v(" "),t("td",[e._v("uavcan.node.name")]),e._v(" "),t("td",[e._v("Reboot required")]),e._v(" "),t("td",[e._v("Name of the node")])])])]),e._v(" "),t("p",[e._v("The detailed description of some of these parameters is shown in the chapters below.")]),e._v(" "),t("p",[t("strong",[e._v("1. Log level")])]),e._v(" "),t("p",[e._v("According to the "),t("a",{attrs:{href:"https://dronecan.github.io/Specification/7._List_of_standard_data_types/#loglevel",target:"_blank",rel:"noopener noreferrer"}},[e._v("LogLevel"),t("OutboundLink")],1),e._v(" message, we have 4 log levels:")]),e._v(" "),t("ul",[t("li",[e._v("debug")]),e._v(" "),t("li",[e._v("info")]),e._v(" "),t("li",[e._v("warning")]),e._v(" "),t("li",[e._v("errors")])]),e._v(" "),t("p",[t("code",[e._v("log_level")]),e._v(" parameter might have values described in the table below.")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("Param value")]),e._v(" "),t("th",[e._v("DEBUG")]),e._v(" "),t("th",[e._v("INFO")]),e._v(" "),t("th",[e._v("WARNING")]),e._v(" "),t("th",[e._v("ERROR")]),e._v(" "),t("th",[e._v("Description")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("0")]),e._v(" "),t("td",[e._v("+")]),e._v(" "),t("td",[e._v("+")]),e._v(" "),t("td",[e._v("+")]),e._v(" "),t("td",[e._v("+")]),e._v(" "),t("td",[e._v("Log everything")])]),e._v(" "),t("tr",[t("td",[e._v("1")]),e._v(" "),t("td",[e._v("-")]),e._v(" "),t("td",[e._v("+")]),e._v(" "),t("td",[e._v("+")]),e._v(" "),t("td",[e._v("+")]),e._v(" "),t("td",[e._v("At least INFO level")])]),e._v(" "),t("tr",[t("td",[e._v("2")]),e._v(" "),t("td",[e._v("-")]),e._v(" "),t("td",[e._v("-")]),e._v(" "),t("td",[e._v("+")]),e._v(" "),t("td",[e._v("+")]),e._v(" "),t("td",[e._v("At least WARNING level")])]),e._v(" "),t("tr",[t("td",[e._v("3")]),e._v(" "),t("td",[e._v("-")]),e._v(" "),t("td",[e._v("-")]),e._v(" "),t("td",[e._v("-")]),e._v(" "),t("td",[e._v("+")]),e._v(" "),t("td",[e._v("At least ERROR level")])]),e._v(" "),t("tr",[t("td",[e._v("4")]),e._v(" "),t("td",[e._v("-")]),e._v(" "),t("td",[e._v("-")]),e._v(" "),t("td",[e._v("-")]),e._v(" "),t("td",[e._v("-")]),e._v(" "),t("td",[e._v("Disable logging")])])])]),e._v(" "),t("p",[e._v("0 - log everything, 1 - discard less than info level, 2 - discard less than warn level, 3 -log only errors, 4 - disable logging")]),e._v(" "),t("p",[t("strong",[e._v("2. Mapping configuration")])]),e._v(" "),t("p",[e._v("Mainly parameters are dedicated to PWM mapping configuration. Here we have 2 or 4 groups so called "),t("code",[e._v("pwm1")]),e._v(", "),t("code",[e._v("pwm2")]),e._v(", "),t("code",[e._v("pwm3")]),e._v(", "),t("code",[e._v("pwm4")]),e._v(" of the parameters.")]),e._v(" "),t("blockquote",[t("p",[e._v("Old versions of the software may have different naming of these groups: "),t("code",[e._v("A1")]),e._v(", "),t("code",[e._v("A2")]),e._v(", "),t("code",[e._v("B1")]),e._v(", "),t("code",[e._v("B2")]),e._v(".")])]),e._v(" "),t("p",[e._v("Below you can see a table with their description:")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("Param name")]),e._v(" "),t("th",[e._v("Description")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("pwm*_ch")]),e._v(" "),t("td",[e._v("Index of setpoint channel (RawCommand or ArrayCommand). Default value -1 means disable.")])]),e._v(" "),t("tr",[t("td",[e._v("pwm*_min")]),e._v(" "),t("td",[e._v("PWM duration when setpoint is min (RawCommand is 0 or Command is 0.0)")])]),e._v(" "),t("tr",[t("td",[e._v("pwm*_max")]),e._v(" "),t("td",[e._v("PWM duration when setpoint is max (RawCommand is 8191 or Command is 1.0)")])]),e._v(" "),t("tr",[t("td",[e._v("pwm*_def")]),e._v(" "),t("td",[e._v("PWM duration when setpoint is negative or there is no setpoint at all")])])])]),e._v(" "),t("p",[t("strong",[e._v("3. Node health checks")])]),e._v(" "),t("p",[e._v("The node performs self testing and change his health if something goes unexpected. But sometimes warnings and errors might be annoying, so here you have 3 option to disable some of them.")]),e._v(" "),t("ol",[t("li",[t("code",[e._v("enable_5v_check")]),e._v(" checks 5V node's voltage. If the 5V check is enabled (the parameter value is 1), the node state will be "),t("code",[e._v("ERROR")]),e._v(" if the 5V voltage is less than 4.5V or bigger than 5.5V")]),e._v(" "),t("li",[t("code",[e._v("enable_vin_check")]),e._v(" checks checks node's Vin voltage. Right now it doesn't supported and this check is always disabled.")]),e._v(" "),t("li",[t("code",[e._v("can_bus_check_level")]),e._v(" specifies at which level every CAN bus error will be treated. If the parameter value is 0, the node will ignore all CAN bus errors. If the parameter value is 1 or 2, the node will keep WARNING or ERROR state for 6 seconds.")])]),e._v(" "),t("p",[t("strong",[e._v("4. Node name customization")])]),e._v(" "),t("p",[e._v("If custom node name is not specified, the node name will be defined with the software name: mini v2 node has name "),t("code",[e._v("mini_v2")]),e._v(", micro node name is "),t("code",[e._v("micro")]),e._v(".")]),e._v(" "),t("p",[e._v("You can set the custom node name. It will allow you easier to distinguish different types of nodes. For example, you can set names "),t("code",[e._v("left_aileron")]),e._v(", "),t("code",[e._v("elevators")]),e._v(", "),t("code",[e._v("forward_left_esc")]),e._v(", etc. You need to set name parameter, save parameters and reboot the node.")]),e._v(" "),t("p",[e._v("A few rules:")]),e._v(" "),t("ul",[t("li",[e._v("The name should be human-readable non-empty ASCII string. An empty name is not permitted.")]),e._v(" "),t("li",[e._v("The name can't be changed while the node is running. You need to reboot the node to update the name.")]),e._v(" "),t("li",[e._v("Allowed characters are: a-z (lowercase ASCII letters) 0-9 (decimal digits) . (dot) - (dash) _ (underscore).")])]),e._v(" "),t("h2",{attrs:{id:"_6-3-getting-started-bench-test"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-getting-started-bench-test"}},[e._v("#")]),e._v(" 6.3. Getting started (bench test)")]),e._v(" "),t("p",[e._v("Before mounting on a real vehicle, especially when using the node for the first time, it is recommended to test the node and perform configuration on a bench using "),t("code",[e._v("gui_tool")]),e._v(":")]),e._v(" "),t("ul",[t("li",[e._v("On Linux use the latest "),t("a",{attrs:{href:"https://github.com/dronecan/gui_tool",target:"_blank",rel:"noopener noreferrer"}},[e._v("dronecan/gui_tool"),t("OutboundLink")],1),e._v(",")]),e._v(" "),t("li",[e._v("On Windows consider to use  "),t("a",{attrs:{href:"https://github.com/OpenCyphal-Garage/gui_tool",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenCyphal-Garage/gui_tool"),t("OutboundLink")],1),e._v(".")])]),e._v(" "),t("p",[e._v("The following checklist allows you to test most of the features and configure the most important parameters.")]),e._v(" "),t("p",[t("strong",[e._v("Step 1. Connect the node properly to a sniffer. Initially, when there is no command, the node goes into STANDBY mode and LED should blink with blue color")])]),e._v(" "),t("p",[e._v("The simplest connection scheme just for bench testing and configuration is shown below.")]),e._v(" "),t("p",[t("img",{attrs:{src:o(300),alt:"bench_test_standby",title:"bench_test_standby"}}),e._v("\nFig. uNode connected to a servo and a sniffer without an input command")]),e._v(" "),t("p",[t("img",{attrs:{src:o(301),alt:"bench_test_standby",title:"bench_test_standby"}}),e._v("\nFig. mini v2 connected to a servo and a sniffer without an input command")]),e._v(" "),t("p",[e._v("Here, the node is connected with 2 devices:")]),e._v(" "),t("ul",[t("li",[e._v("a CAN sniffer via CAN (the sniffer is connected to PC via USB and power the node),")]),e._v(" "),t("li",[e._v("a servo is connected via pwm1 channel.")])]),e._v(" "),t("p",[e._v("For other connection schemes, e.g. with ESC and motor, please refer to the hardware page of the corresponding board.")]),e._v(" "),t("p",[e._v("Initially, without any input commands, the node should blink with blue color, which means that the node is in STANDBY state. If the node blinks with Yellow and even Red color it means that the node has a warning or error. You can try to get more info in gui tool. For better understanding of the color, please refer to the "),t("RouterLink",{attrs:{to:"/guide/intro/leds.html"}},[e._v("LED Meaning")]),e._v(" page.")],1),e._v(" "),t("p",[t("strong",[e._v("Step 2.1. Open gui_tool and set baudrate to 1000000")])]),e._v(" "),t("p",[t("img",{attrs:{src:o(304),alt:""}})]),e._v(" "),t("p",[t("strong",[e._v("Step 2.2. Set the local node ID. The node should send data and respond to GetNodeInfo")])]),e._v(" "),t("p",[e._v("Apply the Local Node ID by clicking the button in the corresponding field at the top. Check that the node publishes some data like "),t("code",[e._v("NodeStatus")]),e._v(" and "),t("code",[e._v("GetNodeInfo")]),e._v(". You can quickly press 2 times on the node in "),t("code",[e._v("Online nodes")]),e._v(" list. You should be able to see additional information such as node name, software version, UID, etc.")]),e._v(" "),t("p",[t("img",{attrs:{src:o(429),alt:"gui_tool",title:"gui_tool"}})]),e._v(" "),t("p",[e._v("The node should respond with the software version that suits you (probably it should be the latest available stable version).")]),e._v(" "),t("blockquote",[t("p",[e._v("If your node doesn't send "),t("code",[e._v("GetNodeInfo")]),e._v(" it probably means that your gui_tool is still in anonymous mode. Apply local node ID.")])]),e._v(" "),t("p",[t("strong",[e._v("Step 3. Configure the node ID and name, Store parameters, then reboot it. ID value and name should be updated.")])]),e._v(" "),t("p",[e._v("Select the node ID by changing "),t("code",[e._v("uavcan.node.id")]),e._v(" that fits your CAN-network without ID-collision.")]),e._v(" "),t("p",[e._v("The name is optional thing. It should help you to identify it among other similar nodes. Change it by typeing new name in "),t("code",[e._v("name")]),e._v(" parameter.")]),e._v(" "),t("p",[t("strong",[e._v("Step 4. Check CircuitStatus. The node should measure the input voltages and temperature correctly.")])]),e._v(" "),t("p",[e._v("Use Tools > Subscriber to look at topics.")]),e._v(" "),t("p",[t("img",{attrs:{src:o(276),alt:"circuit_status",title:"circuit_status"}})]),e._v(" "),t("p",[t("img",{attrs:{src:o(305),alt:"device_temperature",title:"device_temperature"}})]),e._v(" "),t("p",[e._v("If you power a node from USB, the voltage should be ~5V.")]),e._v(" "),t("p",[e._v("The temperature may be a slightly higher than in your room.")]),e._v(" "),t("p",[t("strong",[e._v("Step 5. Configure "),t("code",[e._v("command_type")]),e._v(", "),t("code",[e._v("pwm_frequency")]),e._v(", "),t("code",[e._v("pwm*")]),e._v(" and press the reboot button. The node should correctly control a device (servo or ESC) with either Esc or Actuator Panel.")])]),e._v(" "),t("p",[e._v("If the parameters are configured correctly, you can control a servo by moving the sliders. An example with Actuator Panel is shown below:")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th"),e._v(" "),t("th")])]),e._v(" "),t("tbody",[t("tr",[t("td",[t("img",{attrs:{src:o(430),alt:""}})]),e._v(" "),t("td",[t("img",{attrs:{src:o(431),alt:""}})])])])]),e._v(" "),t("p",[e._v("If the node successfully receives the setpoint, it will go into the ENGAGED state, so its internal RGB LED will be solid blue.")]),e._v(" "),t("blockquote",[t("p",[e._v("After the configuration, don't forget to "),t("code",[e._v("Store All")]),e._v(" parameters and reboot the node.")])]),e._v(" "),t("p",[t("strong",[e._v("Step 6. Configure the "),t("code",[e._v("pwm.mot_num_poles")]),e._v(", "),t("code",[e._v("pwm.fb_1_type")]),e._v(" and "),t("code",[e._v("pwm.fb_2_type")]),e._v(" parameters if you use ESC. The node should return EscStatus correctly.")])]),e._v(" "),t("p",[e._v("You need this step only if you use mini v2 node and want to get a feedback from ESC Flame, ESC Thunder or ESC Alpha.")]),e._v(" "),t("p",[e._v("To enable a specific feedback type, you should set the corresponded value to "),t("code",[e._v("pwm.fb_*_type")]),e._v(" parameters. At that moment a node expect that both paramaters are configured in the same mode:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("pwm.fb_1_type")]),e._v(" is the "),t("code",[e._v("RX")]),e._v(" pin between "),t("code",[e._v("PWM3")]),e._v(" and "),t("code",[e._v("GND")]),e._v(",")]),e._v(" "),t("li",[t("code",[e._v("pwm.fb_2_type")]),e._v(" is the "),t("code",[e._v("RX")]),e._v(" pin between "),t("code",[e._v("PWM4")]),e._v(" and "),t("code",[e._v("GND")]),e._v(".")])]),e._v(" "),t("p",[e._v("If you use ESC Flame, set both paramters value to 1.")]),e._v(" "),t("p",[e._v("If you use ESC Thunder, set both paramters value to 2. You additionally need to set "),t("code",[e._v("pwm.3_ch")]),e._v(" and "),t("code",[e._v("pwm.4_ch")]),e._v(" to -2 to configure them as GPIO SET (3.3 V).")]),e._v(" "),t("p",[e._v("If you use ESC Alpha, set both paramters value to 3.")]),e._v(" "),t("p",[e._v("Otherwise, set these paramters to 0.")]),e._v(" "),t("p",[e._v("Since an ESC doesn't know about number of motors poles, yuo should specify the correct number into "),t("code",[e._v("pwm.mot_num_poles")]),e._v(" paramter.")]),e._v(" "),t("p",[e._v("You can check this using ESC Panel and Tools > Subscriber.")]),e._v(" "),t("p",[t("strong",[e._v("Step 7. Configure the "),t("code",[e._v("cmd_ttl_ms")]),e._v(" parameter. When you close the ESC or Actuator Panel, the node will go to STANDBY mode after the specified period of time, where all PWM channels should have the default values.")])]),e._v(" "),t("p",[e._v("This is a safety feature. You typically don't want a motor\nto continue spinning if your autopilot fails or the CAN-wire is broken.")]),e._v(" "),t("p",[t("strong",[e._v("Step 8. Configure "),t("code",[e._v("log_level")]),e._v(". If it is not the default, the node should report about TTL timeout event in Log messages.")])]),e._v(" "),t("p",[e._v("You can play with "),t("code",[e._v("log_level")]),e._v(" to get the notification level you need for your logging system. By default, the node notifies only about real critical events.")]),e._v(" "),t("p",[t("strong",[e._v("Step 9. Check the "),t("code",[e._v("flight_time_sec")]),e._v(" parameter. After the node goes to STANDBY state, it should increment the "),t("code",[e._v("flight_time_sec")]),e._v(" parameter value within a short time .")])]),e._v(" "),t("p",[e._v("Typically, you should set this parameter to 0 before mounting the node in a vehicle, but it is up to you.")]),e._v(" "),t("p",[t("strong",[e._v("Step 10. Specify the strictness of onboard checks.")])]),e._v(" "),t("p",[e._v("The current list of checks that you are able to modify are: "),t("code",[e._v("enable_5v_check")]),e._v(", "),t("code",[e._v("enable_vin_check")]),e._v(", "),t("code",[e._v("can_bus_check_level")]),e._v(" and "),t("code",[e._v("log_level")]),e._v(".")]),e._v(" "),t("p",[e._v("Some more checks might be appeared in the future.")]),e._v(" "),t("h2",{attrs:{id:"_6-4-px4-integration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-px4-integration"}},[e._v("#")]),e._v(" 6.4. PX4 integration")]),e._v(" "),t("p",[e._v("It is recommended to use PX4 v1.13 or newer with "),t("a",{attrs:{href:"https://docs.px4.io/main/en/concept/control_allocation.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Control Allocation"),t("OutboundLink")],1),e._v(".")]),e._v(" "),t("p",[e._v("You can integrate this node with PX4 by performing the following steps:")]),e._v(" "),t("ol",[t("li",[e._v("Choose the direred airframe and reboot the vehicle")]),e._v(" "),t("li",[e._v("According to the "),t("a",{attrs:{href:"https://docs.px4.io/master/en/uavcan/",target:"_blank",rel:"noopener noreferrer"}},[e._v("PX4 user guide"),t("OutboundLink")],1),e._v(" you need to set "),t("code",[e._v("UAVCAN_ENABLE")]),e._v(" parameter to "),t("code",[e._v("3")]),e._v(" value and reboot the autopilot")]),e._v(" "),t("li",[e._v("Configure Actuators and test them. Check "),t("a",{attrs:{href:"https://docs.px4.io/main/en/config/actuators.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("the official instruction"),t("OutboundLink")],1),e._v(" for details.")])]),e._v(" "),t("p",[e._v("PX4 v1.14 sends 2 commands: "),t("code",[e._v("esc.RawCommand")]),e._v(" for ESC (values from 0 to 8191) and "),t("code",[e._v("actuator.ArrayCommand")]),e._v(" for control surfaces (values from -1.0 to 1.0).")]),e._v(" "),t("p",[e._v("An examples of the DroneCAN configuration for specific vehicles will appear here soon:")]),e._v(" "),t("ul",[t("li",[t("RouterLink",{attrs:{to:"/guide/examples/small_quadcopter.html"}},[e._v("PX4 Small quadcopter example")])],1),e._v(" "),t("li",[t("RouterLink",{attrs:{to:"/guide/examples/plane.html"}},[e._v("PX4 X-UAV Mini Talon example")])],1),e._v(" "),t("li",[t("code",[e._v("PX4 Generic quad delta VTOL example")])]),e._v(" "),t("li",[t("RouterLink",{attrs:{to:"/guide/examples/vtol.html"}},[e._v("PX4 VTOL example")])],1)]),e._v(" "),t("h2",{attrs:{id:"_6-5-software-versions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-software-versions"}},[e._v("#")]),e._v(" 6.5. Software versions")]),e._v(" "),t("p",[e._v("History of all releases and changes related to the node:")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("Version")]),e._v(" "),t("th",[e._v("Date")]),e._v(" "),t("th",[e._v("Description")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[t("a",{attrs:{href:"https://github.com/RaccoonlabDev/docs/releases/tag/v0.13.0",target:"_blank",rel:"noopener noreferrer"}},[e._v("v0.13.0 27d18a2"),t("OutboundLink")],1)]),e._v(" "),t("td",[e._v("Aug 23, 2023")]),e._v(" "),t("td",[e._v("- Add ESC Alpha")])]),e._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://github.com/RaccoonlabDev/docs/releases/tag/v0.12.2",target:"_blank",rel:"noopener noreferrer"}},[e._v("v0.12.2 0601cb2"),t("OutboundLink")],1)]),e._v(" "),t("td",[e._v("Aug 09, 2023")]),e._v(" "),t("td",[e._v("- Fix ESC Thunder RPM scaling.")])]),e._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://github.com/RaccoonlabDev/docs/releases/tag/v0.12.0",target:"_blank",rel:"noopener noreferrer"}},[e._v("v0.12.0 41023e0"),t("OutboundLink")],1)]),e._v(" "),t("td",[e._v("Jul 25, 2023")]),e._v(" "),t("td",[e._v("- Add ESC Thunder feedback support and feedback forwarder mode. "),t("br"),e._v(" - Fix ArrayCommand range (it was from 0.0 to 1.0, now it is from -1.0 to 1.0) "),t("br"),e._v(" - Add meaningful default node name (it was unknown by default)")])]),e._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://github.com/RaccoonlabDev/docs/releases/tag/v0.10.17",target:"_blank",rel:"noopener noreferrer"}},[e._v("v0.10.17 3960cc2"),t("OutboundLink")],1)]),e._v(" "),t("td",[e._v("Mar 29, 2023")]),e._v(" "),t("td",[e._v("- Fix bug with "),t("code",[e._v("cmd_ttl_ms")]),e._v(" "),t("br"),e._v(" - Send ESC feedback only when it is availiable, not with a fixed period "),t("br"),e._v(" - Update names of the most of parameters")])]),e._v(" "),t("tr",[t("td",[e._v("v0.9.10 9fe8120")]),e._v(" "),t("td",[e._v("Dec 10, 2022")]),e._v(" "),t("td",[t("strong",[e._v("Bug found: cmd_ttl_ms doesn't work. Do not use this version of the firmware.")]),e._v(" "),t("br"),e._v(" - Add mot_num_poles "),t("br"),e._v(" - Add parameters to disable esc_status "),t("br"),e._v(" - Update internal LED standard for all v2 hardware "),t("br"),e._v(" - Add can_bus_check_level")])]),e._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://github.com/RaccoonlabDev/docs/releases/tag/v0.8.8-stable",target:"_blank",rel:"noopener noreferrer"}},[e._v("v0.8.8-stable    f915a39"),t("OutboundLink")],1)]),e._v(" "),t("td",[e._v("Sep 14, 2022")]),e._v(" "),t("td",[e._v("- Add Mini v2 and Micro boards "),t("br"),e._v(" - Add CAN-bus error status monitor "),t("br"),e._v(" - Add string name "),t("br"),e._v(" - Add temperature sensor "),t("br"),e._v(" - Add custom pwm frequency "),t("br"),e._v(" - Improve transport stats")])]),e._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://github.com/RaccoonlabDev/docs/releases/tag/v0.5.8-stable",target:"_blank",rel:"noopener noreferrer"}},[e._v("v0.5.7    f951dc6"),t("OutboundLink")],1)]),e._v(" "),t("td",[e._v("May 06, 2022")]),e._v(" "),t("td",[e._v("- Use individual TTL for each setpoint instead of a single one")])]),e._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://github.com/RaccoonlabDev/docs/releases/tag/v0.5.2-stable",target:"_blank",rel:"noopener noreferrer"}},[e._v("v0.5.2.1  a208527"),t("OutboundLink")],1)]),e._v(" "),t("td",[e._v("Apr 5, 2022")]),e._v(" "),t("td",[e._v("- Extended Mini v1 RC channels amount to 20, "),t("br"),e._v(" - Add ArrayCommand "),t("br"),e._v(" - Add LogMessages "),t("br"),e._v(" - Add Watchdog "),t("br"),e._v(" - Add Flight time recorder")])]),e._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://github.com/RaccoonlabDev/docs/releases/tag/v0.4.5-extended",target:"_blank",rel:"noopener noreferrer"}},[e._v("v0.3.2.1  3aaaacf"),t("OutboundLink")],1)]),e._v(" "),t("td",[e._v("Mar 28, 2022")]),e._v(" "),t("td",[e._v("Mini v1 esc-flame with extended RC channels amount to 20")])]),e._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://github.com/RaccoonlabDev/docs/releases/tag/v0.3.2",target:"_blank",rel:"noopener noreferrer"}},[e._v("v0.3.2    0b55576"),t("OutboundLink")],1)]),e._v(" "),t("td",[e._v("May 31, 2021")]),e._v(" "),t("td",[e._v("Mini v1 esc-flame feedback first release")])]),e._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://github.com/RaccoonlabDev/docs/releases/tag/v0.4.5-extended",target:"_blank",rel:"noopener noreferrer"}},[e._v("v0.3.0.1  699cbd6"),t("OutboundLink")],1)]),e._v(" "),t("td",[e._v("Mar 28, 2022")]),e._v(" "),t("td",[e._v("Mini v1 (4 channels) with extended RC channels amount to 20")])]),e._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://github.com/RaccoonlabDev/docs/releases/tag/v0.3.0-alpha",target:"_blank",rel:"noopener noreferrer"}},[e._v("v0.3.0    04866c1"),t("OutboundLink")],1)]),e._v(" "),t("td",[e._v("Apr 05, 2021")]),e._v(" "),t("td",[e._v("Mini v1 (4 channels) first release")])])])]),e._v(" "),t("blockquote",[t("p",[e._v("Note that Mini v1 will not have further software updates. It is recommended to use mini v2 instead.")])])])}),[],!1,null,null,null);t.default=r.exports}}]);